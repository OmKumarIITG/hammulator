From 00d658dc15540f513e4182f91d600de7689e8869 Mon Sep 17 00:00:00 2001
From: Fabian Thomas <fabian@fabianthomas.de>
Date: Fri, 16 Jun 2023 10:57:18 +0200
Subject: [PATCH 5/7] DRAMsim3: use dual channel 8Gb

---
 src/python/gem5/components/memory/dramsim_3.py | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/python/gem5/components/memory/dramsim_3.py b/src/python/gem5/components/memory/dramsim_3.py
index a30adfefef..62687d9697 100644
--- a/src/python/gem5/components/memory/dramsim_3.py
+++ b/src/python/gem5/components/memory/dramsim_3.py
@@ -93,7 +93,8 @@ class SingleChannel(AbstractMemorySystem):
         :param num_chnls: The number of channels.
         """
         super().__init__()
-        self.mem_ctrl = DRAMSim3MemCtrl(mem_type, 1)
+        # TODO: two channels?
+        self.mem_ctrl = DRAMSim3MemCtrl(mem_type, 2)
         self._size = toMemorySize(size)
         if not size:
             raise NotImplementedError(
@@ -119,6 +120,8 @@ class SingleChannel(AbstractMemorySystem):
     @overrides(AbstractMemorySystem)
     def set_memory_range(self, ranges: List[AddrRange]) -> None:
         if len(ranges) != 1 or ranges[0].size() != self._size:
+            # TODO: something is totally broken with this check
+            # it works with two channels
             raise Exception(
                 "Single channel DRAMSim memory controller requires a single "
                 "range which matches the memory's size."
@@ -143,7 +146,7 @@ def SingleChannelDDR4_2400(size: Optional[str] = "1024MB") -> SingleChannel:
 
     :param size: The size of the memory system. Default value of 1024MB.
     """
-    return SingleChannel("DDR4_4Gb_x8_2400", size)
+    return SingleChannel("DDR4_8Gb_x8_2400", size)
 
 
 def SingleChannelLPDDR3_1600(size: Optional[str] = "256MB") -> SingleChannel:
-- 
2.41.0

